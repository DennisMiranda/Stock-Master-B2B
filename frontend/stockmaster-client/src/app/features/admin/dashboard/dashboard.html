<div class="p-4 md:p-6 lg:p-8 space-y-6 animate-in fade-in duration-500 pb-20">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
        <div>
            <h1 class="text-xl sm:text-2xl font-bold text-gray-900 tracking-tight">Dashboard Financiero & Logístico</h1>
            <p class="text-xs sm:text-sm text-gray-500 mt-1">Visión general del rendimiento y alertas de inventario</p>
        </div>

        @if (isLoading()) {
        <div
            class="flex items-center gap-2 text-indigo-600 animate-pulse bg-indigo-50 px-3 py-1.5 rounded-full text-xs font-medium self-start sm:self-auto">
            <span class="w-2 h-2 bg-indigo-600 rounded-full"></span>
            Actualizando datos...
        </div>
        }
    </div>

    @if (stats(); as data) {
    <!-- SECCIÓN 1: PRODUCTOS ESTRELLA (Top Selling) -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6">
        <!-- Top Unidades -->
        <app-stat-card title="Más Vendidos (Unidades)" subtitle="Venta al por menor" [icon]="PackageIcon"
            colorScheme="blue" [items]="topUnitsItems()" valueLabel="Unidades" itemSubtitle="Unidad Individual">
        </app-stat-card>

        <!-- Top Cajas -->
        <app-stat-card title="Más Vendidos (Cajas)" subtitle="Venta Mayorista" [icon]="BoxIcon" colorScheme="amber"
            [items]="topBoxesItems()" valueLabel="Cajas" itemSubtitle="Caja Master">
        </app-stat-card>
    </section>

    <!-- SECCIÓN 2: URGENCIA (Low Stock) -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 pt-2">
        <!-- Low Stock Unidades -->
        <app-low-stock-card title="Stock Crítico: Unidades" stockType="unit" colorScheme="red" [items]="lowStockUnits()"
            actionLabel="Reponer Urgente" [placeholderIcon]="PackageIcon">
        </app-low-stock-card>

        <!-- Low Stock Cajas -->
        <app-low-stock-card title="Stock Crítico: Cajas" stockType="box" colorScheme="orange" [items]="lowStockBoxes()"
            actionLabel="Solicitar Proveedor" [placeholderIcon]="BoxIcon">
        </app-low-stock-card>
    </section>
    }

    @else {
    <!-- Skeleton State -->
    <div class="animate-pulse space-y-6">
        <!-- Top Selling Grid Skeleton -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6">
            <div class="h-64 sm:h-80 bg-gray-100 rounded-2xl border border-gray-200"></div>
            <div class="h-64 sm:h-80 bg-gray-100 rounded-2xl border border-gray-200"></div>
        </div>
        <!-- Low Stock Grid Skeleton -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6">
            <div class="h-48 sm:h-64 bg-gray-100 rounded-xl border border-gray-200"></div>
            <div class="h-48 sm:h-64 bg-gray-100 rounded-xl border border-gray-200"></div>
        </div>
    </div>
    }
</div>